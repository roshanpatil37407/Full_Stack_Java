package jdbc;

import java.sql.*;
import java.util.Scanner;

public class CRUP_Operations {
	  public static void main(String[] args) {
	        Scanner sc = new Scanner(System.in);

	        try {
	            // 1. Load driver
	            Class.forName("com.mysql.cj.jdbc.Driver");

	            // 2. Connect to database
	            Connection con = DriverManager.getConnection(
	                    "jdbc:mysql://localhost:3306/Roshu", "root", "root");
	            
	            
	            int choise;
	            do {
	            	System.out.println("INSERT");
	            	System.out.println("UPDATE");
	            	System.out.println("DELET");
	            	System.out.println("FETCH");
	            	System.out.println("CALL");
	            	System.out.println("EXIT");
	            	System.out.print("Enter choice: ");
	            	choise=sc.nextInt();	
	            	
	            	switch(choise) {
	            	case 1:
	            		System.out.print("Enter Name: ");
                        String name = sc.next();
                        System.out.print("Enter Salary: ");
                        double salary = sc.nextDouble();
                        
                        String sql="insert into emp values(?,?)";
                        PreparedStatement  ps=con.prepareStatement(sql);
                        ps.setString(1,name);
                        ps.setDouble(2,salary);
                        ps.executeUpdate();
                        System.out.println("INSERT DATA SUCCESFULLY");
                        break;
	            	case 2:
	            		   System.out.print("Enter Employee ID to Update: ");
	                        int u = sc.nextInt();
	                        System.out.print("Enter New Salary: ");
	                        double ns = sc.nextDouble();
	                        String uq="update emp set salary = ? where =?";
	                        PreparedStatement  psu=con.prepareStatement(uq);
	                        psu.setDouble(1, ns);
	                        psu.setInt(2, u);
	                        int updated = psu.executeUpdate();
	                        if (updated > 0)
	                            System.out.println("Salary Updated Successfully!");
	                        else
	                            System.out.println(" Employee Not Found!");
	                        break;
	                        
	            	case 3:
	            		 System.out.print("Enter Employee ID to Delete: ");
	                        int de = sc.nextInt();

	                        String dl = "DELETE FROM employee_new WHERE id = ?";
	                        PreparedStatement dls = con.prepareStatement(dl);
	                        int deleted = dls.executeUpdate();
	                        if (deleted > 0)
	                            System.out.println("Employee Deleted Successfully!");
	                        else
	                            System.out.println("Employee Not Found!");
	                        break;
	                        
	            	case 4:
	            		String s = "SELECT * FROM employee_new";
                        Statement stmt = con.createStatement();
                        ResultSet rs = stmt.executeQuery(s);

                        System.out.println("\nID | Name | Salary");
                        System.out.println("--------------------");
                        while (rs.next()) {
                            System.out.println(
                                    rs.getInt("id") + " | " +
                                    rs.getString("name") + " | " +
                                    rs.getDouble("salary"));
                        }
                        break;
	                        
	                        
                        
	            	}
	            	
	            
	            }while(choise !=6);
	            
	            
	            
	            
	            
	            
	        }catch(Exception e) {
	        	
	        }
	  }
	  
}
